<!DOCTYPE html>
<html lang="ko">
<head>
  <script>
  if (!sessionStorage.getItem("introDone")) {
    location.replace("intro.html");
  }
</script>
  <meta charset="UTF-8" />
  <title>CleanMate â€“ ì²­ì†Œ ê²¬ì ë¶€í„° ì˜ˆì•½ê¹Œì§€, í•œ ë²ˆì—</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

   body {
  font-family: -apple-system, BlinkMacSystemFont, "Noto Sans KR", system-ui, sans-serif;
  background: #f5f7fb;
  color: #222;
  line-height: 1.5;
}

    a {
      text-decoration: none;
      color: inherit;
    }

    .page {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* HEADER */

    header {
      position: sticky;
      top: 0;
      z-index: 50;
      background: rgba(245, 247, 251, 0.96);
      backdrop-filter: blur(12px);
      border-bottom: 1px solid rgba(0,0,0,0.04);
    }

    .header-inner {
      max-width: 1200px;
      margin: 0 auto;
      padding: 14px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
    }

    .logo-wrap {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .logo-wrap img {
      height: 40px;
      width: auto;
    }

    .logo-text-main {
      font-weight: 700;
      font-size: 20px;
      color: #0288d1;
    }

    .logo-text-sub {
      font-size: 12px;
      color: #5f6a7a;
    }

    .header-cta {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 13px;
      color: #5f6a7a;
    }

    .header-cta button {
      border: none;
      padding: 8px 16px;
      border-radius: 999px;
      background: #0288d1;
      color: #fff;
      font-size: 13px;
      cursor: pointer;
      font-weight: 600;
      box-shadow: 0 4px 10px rgba(2, 136, 209, 0.25);
    }

    .header-cta button:hover {
      background: #0073b0;
    }

    /* HERO */

    .hero {
      flex: 1;
      max-width: 1200px;
      margin: 24px auto 32px;
      padding: 0 20px;
      display: grid;
      grid-template-columns: minmax(0, 1.2fr) minmax(0, 1fr);
      gap: 32px;
      align-items: center;
    }

    @media (max-width: 960px) {
      .hero {
        grid-template-columns: 1fr;
      }
    }

    .hero-card {
      background: #ffffff;
      border-radius: 24px;
      padding: 28px 28px 24px;
      box-shadow: 0 16px 40px rgba(15, 35, 52, 0.10);
      border: 1px solid rgba(2, 136, 209, 0.06);
    }

    .hero-badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 12px;
      border-radius: 999px;
      font-size: 12px;
      background: #e0f7fa;
      color: #0277bd;
      margin-bottom: 18px;
    }

    .hero-badge span.icon {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 18px;
      height: 18px;
      border-radius: 999px;
      background: #0288d1;
      color: #fff;
      font-size: 11px;
    }

    .hero-title {
      font-size: 28px;
      font-weight: 800;
      color: #222;
      margin-bottom: 10px;
    }

    .hero-title strong {
      color: #0288d1;
    }

    .hero-subtitle {
      font-size: 15px;
      color: #5f6a7a;
      margin-bottom: 20px;
    }

    .hero-list {
      list-style: none;
      font-size: 13px;
      color: #4b5665;
      margin-bottom: 22px;
    }

    .hero-list li {
      display: flex;
      align-items: flex-start;
      gap: 8px;
      margin-bottom: 6px;
    }

    .hero-list li span.dot {
      margin-top: 4px;
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: #81d4fa;
      flex-shrink: 0;
    }

    .hero-cta-row {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 10px;
      margin-bottom: 8px;
    }

    .hero-main-btn {
      position: relative;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      padding: 12px 22px;
      border-radius: 999px;
      background: #0288d1;
      color: #fff;
      font-weight: 700;
      border: none;
      cursor: pointer;
      font-size: 14px;
      box-shadow: 0 14px 22px rgba(2, 136, 209, 0.30);
    }

    .hero-main-btn span.icon {
      font-size: 15px;
    }

    .hero-caption {
      font-size: 11px;
      color: #8a94a6;
    }

    .hero-caption strong {
      color: #0288d1;
      font-weight: 600;
    }

    /* HERO â€“ RIGHT : ì•„ì´ì½˜í˜• ì„œë¹„ìŠ¤ ì¹´ë“œ */

    .hero-ba {
      background: #ffffff;
      border-radius: 24px;
      padding: 18px 18px 20px;
      box-shadow: 0 16px 40px rgba(15, 35, 52, 0.08);
      border: 1px solid rgba(2, 136, 209, 0.04);
      display: flex;
      flex-direction: column;
      gap: 14px;
    }

    .hero-ba-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .hero-ba-header-title {
      font-size: 16px;
      font-weight: 700;
      color: #222;
    }

    .hero-ba-header-sub {
      font-size: 11px;
      color: #5f6a7a;
    }

    .hero-ba-illustration {
      background: linear-gradient(135deg, #e3f2fd, #e0f7fa);
      border-radius: 18px;
      padding: 14px 14px 16px;
      display: grid;
      grid-template-columns: minmax(0, 1.2fr) minmax(0, 1fr);
      gap: 10px;
      align-items: center;
    }

    @media (max-width: 500px) {
      .hero-ba-illustration {
        grid-template-columns: 1fr;
      }
    }

    .hero-ba-left-title {
      font-size: 13px;
      font-weight: 700;
      color: #01579b;
      margin-bottom: 4px;
    }

    .hero-ba-left-text {
      font-size: 11px;
      color: #1565c0;
    }

    .hero-ba-badges {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 8px;
    }

    .hero-ba-badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 4px 8px;
      border-radius: 999px;
      background: rgba(255,255,255,0.9);
      font-size: 11px;
      color: #01579b;
    }

    .hero-ba-badge span.icon {
      width: 16px;
      height: 16px;
      border-radius: 999px;
      background: #0288d1;
      color: #fff;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
    }

    .hero-ba-right {
      display: flex;
      flex-direction: column;
      gap: 6px;
      font-size: 11px;
      color: #01579b;
    }

    .hero-ba-pill-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .hero-ba-pill {
      padding: 4px 7px;
      border-radius: 999px;
      background: rgba(255,255,255,0.9);
      font-size: 10px;
      color: #1565c0;
    }

    .hero-ba-stats {
      display: flex;
      justify-content: space-between;
      font-size: 11px;
      color: #607084;
    }

    .hero-ba-stats strong {
      color: #01579b;
    }

    /* SECTION: ê²¬ì  ì…ë ¥ */

    .section {
      max-width: 1200px;
      margin: 0 auto 42px;
      padding: 0 20px;
    }

    .section-title-row {
      display: flex;
      justify-content: space-between;
      align-items: flex-end;
      margin-bottom: 14px;
      gap: 10px;
    }

    .section-title {
      font-size: 20px;
      font-weight: 700;
      color: #222;
    }

    .section-subtitle {
      font-size: 12px;
      color: #5f6a7a;
    }

    .estimate-grid {
      display: grid;
      grid-template-columns: minmax(0, 1.1fr) minmax(0, 1fr);
      gap: 16px;
    }

    @media (max-width: 960px) {
      .estimate-grid {
        grid-template-columns: 1fr;
      }
    }

    .card {
      background: #ffffff;
      border-radius: 20px;
      padding: 18px 18px 18px;
      box-shadow: 0 10px 28px rgba(15, 35, 52, 0.08);
      border: 1px solid rgba(0,0,0,0.03);
    }

    .card-title {
      font-size: 15px;
      font-weight: 700;
      margin-bottom: 10px;
      color: #222;
    }

    .field {
      margin-bottom: 10px;
      font-size: 13px;
    }

    .field label {
      display: block;
      margin-bottom: 4px;
      color: #4b5665;
      font-weight: 500;
    }

    .field small {
      display: block;
      font-size: 11px;
      color: #8a94a6;
      margin-top: 2px;
    }

    input[type="text"],
    input[type="number"],
    select {
      width: 100%;
      border-radius: 10px;
      border: 1px solid #d1d9e6;
      padding: 8px 10px;
      font-size: 13px;
      outline: none;
      background: #f9fafc;
    }

    input:focus,
    select:focus {
      border-color: #0288d1;
      box-shadow: 0 0 0 1px rgba(2, 136, 209, 0.45);
      background: #ffffff;
    }

    .checkbox-row {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 13px;
      margin-bottom: 6px;
      color: #4b5665;
    }

    .checkbox-row input {
      transform: translateY(1px);
    }

    .options-row {
      display: flex;
      gap: 8px;
      align-items: center;
      margin-top: 4px;
    }

    .counter {
      display: inline-flex;
      align-items: center;
      border-radius: 999px;
      background: #f1f4fb;
      padding: 3px 8px;
      gap: 4px;
    }

    .counter button {
      width: 20px;
      height: 20px;
      border-radius: 999px;
      border: none;
      background: #e0f2ff;
      color: #1565c0;
      font-size: 13px;
      cursor: pointer;
      font-weight: 700;
    }

    .counter span {
      min-width: 18px;
      text-align: center;
      font-size: 12px;
      color: #374151;
    }

    .upload-area {
      border-radius: 12px;
      border: 1px dashed #b0bec5;
      background: #f9fafc;
      padding: 14px;
      text-align: center;
      font-size: 12px;
      color: #607084;
      margin-bottom: 10px;
    }

    .upload-area input {
      margin-top: 8px;
    }

    .primary-btn {
      width: 100%;
      padding: 11px 16px;
      border-radius: 999px;
      border: none;
      background: #0288d1;
      color: #ffffff;
      font-size: 14px;
      font-weight: 700;
      cursor: pointer;
      margin-top: 8px;
      box-shadow: 0 12px 20px rgba(2, 136, 209, 0.26);
    }

    .primary-btn:hover {
      background: #0073b0;
    }

    .small-note {
      font-size: 11px;
      color: #8a94a6;
      margin-top: 8px;
    }

    /* ê²°ê³¼ ì¹´ë“œ */

    .result-row {
      display: flex;
      flex-direction: column;
      gap: 10px;
      font-size: 13px;
    }

    .result-summary {
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 8px;
      border-bottom: 1px dashed #e0e7f0;
      padding-bottom: 8px;
    }

    .result-summary strong {
      font-size: 16px;
      color: #0288d1;
    }

    .result-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 6px;
    }

    .result-table th,
    .result-table td {
      padding: 6px 4px;
      border-bottom: 1px solid #eef2f7;
      font-size: 11px;
      text-align: center;
    }

    .result-table th {
      background: #f3f6fb;
      color: #4b5665;
      font-weight: 600;
    }

    .result-table td.label {
      text-align: left;
      padding-left: 6px;
    }

    /* SECTION: Before & After GAL */

    .ba-grid {
      display: grid;
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap: 12px;
    }

    @media (max-width: 1100px) {
      .ba-grid {
        grid-template-columns: repeat(3, minmax(0, 1fr));
      }
    }

    @media (max-width: 800px) {
      .ba-grid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    @media (max-width: 520px) {
      .ba-grid {
        grid-template-columns: 1fr;
      }
    }

    .ba-card {
      background: #ffffff;
      border-radius: 18px;
      overflow: hidden;
      box-shadow: 0 8px 22px rgba(15, 35, 52, 0.06);
      border: 1px solid rgba(0,0,0,0.03);
    }

    .ba-card img {
      width: 100%;
      display: block;
    }

    .ba-card-footer {
      padding: 8px 10px 9px;
      font-size: 11px;
      color: #4b5665;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 6px;
    }

    .ba-card-footer span.tag {
      padding: 3px 8px;
      border-radius: 999px;
      background: #e3f2fd;
      color: #1565c0;
      font-size: 10px;
    }

    /* FOOTER */

    footer {
      border-top: 1px solid rgba(0,0,0,0.04);
      background: #ffffff;
    }

    .footer-inner {
      max-width: 1200px;
      margin: 0 auto;
      padding: 14px 20px 18px;
      font-size: 11px;
      color: #90a0b5;
      display: flex;
      justify-content: space-between;
      gap: 8px;
      flex-wrap: wrap;
    }

    .footer-inner strong {
      color: #5f6a7a;
    }
    
/* âœ… ë©”ì¸ íƒ­ ë²„íŠ¼ */
.tab-btn{
  padding:10px 18px;
  border-radius:999px;
  border:1.5px solid #0288d1;
  background:#fff;
  color:#0288d1;
  font-size:13px;
  font-weight:700;
  cursor:pointer;
}

.tab-btn.active{
  background:#0288d1;
  color:#fff;
}
  .review-btn{
  flex:1;
  padding:10px;
  border-radius:999px;
  border:1.5px solid #0288d1;
  background:#fff;
  color:#0288d1;
  font-size:13px;
  font-weight:700;
  cursor:pointer;
}

.review-btn:hover{
  background:#e3f2fd;
}  
  </style>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
<script>
  const SUPABASE_URL = "https://nuchpyxjyqcpldpnffhu.supabase.co";
  const SUPABASE_KEY = "sb_publishable_edX6Oi2eo5A5MjYYo323Fg_6ESnzQmL";

  const supabaseClient = supabase.createClient(
    SUPABASE_URL,
    SUPABASE_KEY
  );
</script>
</head>
<body>
<div class="page">

  <!-- HEADER -->
  <header>
    <div class="header-inner">
      <div class="logo-wrap">
        <img src="logo-cleanmate.png" alt="CleanMate ë¡œê³ " />
        <div>
          <div class="logo-text-main">CleanMate</div>
          <div class="logo-text-sub">ì²­ì†Œ ê²¬ì ë¶€í„° ì˜ˆì•½ê¹Œì§€, í•œ ë²ˆì—</div>
        </div>
          
      </div>
      <div class="header-cta">
        <span>ì‹¤ì œ ì²­ì†Œ ê¸°ì¤€ ë‹¨ê°€ë¡œ ìë™ ê³„ì‚°</span>
        <button type="button" onclick="goMyPage()"
  style="
    border:1px solid #0288d1;
    background:#fff;
    color:#0288d1;
  ">
  ë‚˜ì˜ ì˜ˆì•½ Â· ë°°ì • í˜„í™© í™•ì¸
</button>
      </div>
    </div>
  </header>

  <!-- HERO -->
  <main>

    <section class="hero">
      <!-- LEFT -->
      <div class="hero-card">
 
   <div class="hero-badge">
    <span class="icon">â˜…</span>
    ì²­ì†Œ ê²¬ì ë¶€í„° ì˜ˆì•½ê¹Œì§€, í•œ ë²ˆì—
  </div>

        <h1 class="hero-title">
          ë¶ˆíˆ¬ëª…í•œ ê²¬ì ê³¼ ê°‘ì‘ìŠ¤ëŸ¬ìš´ ì¶”ê°€ìš”ê¸ˆ,<br />
          ì´ì œ <strong>í´ë¦°ë©”ì´íŠ¸</strong>ê°€ ë§‰ì•„ë“œë¦½ë‹ˆë‹¤.
        </h1>

        <p class="hero-subtitle">
          êµ¬ì¡°Â·í‰ìˆ˜Â·ì˜µì…˜ê³¼ ì˜¤ì—¼ë„ê¹Œì§€ ë°˜ì˜í•´<br />
          ì‹¤ì œ ì²­ì†Œ ê¸°ì¤€ ë‹¨ê°€ë¡œ í•©ë¦¬ì ì¸ ê²¬ì ì„ ê³„ì‚°í•©ë‹ˆë‹¤.
        </p>

        <ul class="hero-list">
          <li><span class="dot"></span>ì‚¬ì§„ ìµœëŒ€ 30ì¥ ì—…ë¡œë“œ &nbsp;Â·&nbsp; ì˜¤ì—¼ë„ë³„ ì¶”ê°€ìš”ê¸ˆ ìë™ ì‚°ì •</li>
          <li><span class="dot"></span>ì›ë£¸Â·íˆ¬ë£¸Â·ì“°ë¦¬ë£¸Â·ë³µì¸µ &nbsp;Â·&nbsp; ê±°ì£¼ì²­ì†ŒÂ·ë¶™ë°•ì´ì¥Â·ì£¼ë°© ì˜µì…˜ ì„ íƒ</li>
          <li><span class="dot"></span>í˜„ì¥ ë„ì°© í›„ ê³¼ë„í•œ ì¶”ê°€ìš”ê¸ˆì„ ë§‰ê¸° ìœ„í•œ ê¸°ì¤€ ê²¬ì  ì œê³µ</li>
        </ul>

        <div class="hero-cta-row">
          <button class="hero-main-btn" type="button" onclick="showMainSection('estimate')">
            <span class="icon">âš¡</span>
            ì§€ê¸ˆ ì²­ì†Œ ê²¬ì  ë°”ë¡œ ë°›ì•„ë³´ê¸°
          </button>
          <span class="hero-caption">
            êµ¬ì¡°/ì˜µì…˜ ì…ë ¥ â†’ (ì‚¬ì§„ ì„ íƒ) â†’ <strong>ì˜ˆìƒ ì´ ê²¬ì  ì¦‰ì‹œ í™•ì¸</strong>
          </span>
        </div>

        <p class="hero-caption">
          ì‹¤ì œ ì²­ì†ŒíŒ€ì´ ì‚¬ìš©í•˜ëŠ” ë‚´ë¶€ ë‹¨ê°€í‘œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë§Œë“¤ì–´ì¡Œìœ¼ë©°,<br />
          í˜„ì¥ ìƒí™©ì— ë”°ë¼ ìµœì¢… ê¸ˆì•¡ì€ ì¡°ì •ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        </p>
      </div>

      <!-- RIGHT : ì•„ì´ì½˜í˜• ì„œë¹„ìŠ¤ ì¹´ë“œ -->
      <div class="hero-ba">
        <div class="hero-ba-header">
          <div>
            <div class="hero-ba-header-title">í´ë¦°ë©”ì´íŠ¸ ê²¬ì  ìš”ì•½</div>
            <div class="hero-ba-header-sub">í•œëˆˆì— ë³´ëŠ” ì„œë¹„ìŠ¤ êµ¬ì¡°</div>
          </div>
        </div>

        <div class="hero-ba-illustration">
          <div>
            <div class="hero-ba-left-title">êµ¬ì¡° Â· í‰ìˆ˜ Â· ì˜µì…˜ Â· ì˜¤ì—¼ë„</div>
            <div class="hero-ba-left-text">
              ì§‘ êµ¬ì¡°ì™€ í‰ìˆ˜, ê±°ì£¼ ì—¬ë¶€, ë¶™ë°•ì´ì¥/ì£¼ë°© ì˜µì…˜ì—<br />
              í•„ìš”í•œ ë¶€ë¶„ë§Œ ì‚¬ì§„ìœ¼ë¡œ ì¶”ê°€í•´ ë³´ë‹¤ ì •í™•í•œ ê²¬ì ì„ ì•ˆë‚´í•©ë‹ˆë‹¤.
            </div>
            <div class="hero-ba-badges">
              <div class="hero-ba-badge">
                <span class="icon">ğŸ </span>
                êµ¬ì¡°Â·í‰ìˆ˜ ìë™ ë°˜ì˜
              </div>
              <div class="hero-ba-badge">
                <span class="icon">ğŸ§º</span>
                ê±°ì£¼/ë¶™ë°•ì´/ì£¼ë°© ì˜µì…˜
              </div>
              <div class="hero-ba-badge">
                <span class="icon">ğŸ“·</span>
                ì˜¤ì—¼ë„ ê¸°ì¤€ ì‚¬ì§„ì„ íƒ
              </div>
            </div>
          </div>
          <div class="hero-ba-right">
            <div class="hero-ba-pill-row">
              <div class="hero-ba-pill">22í‰ ì´í•˜ 22ë§Œì› ê¸°ì¤€</div>
              <div class="hero-ba-pill">23í‰ ì´ìƒ í‰ë‹¹ 1ë§Œì›</div>
              <div class="hero-ba-pill">ë¹„í™•ì¥ +5ë§Œì›</div>
              <div class="hero-ba-pill">ë³µì¸µ í‰ë‹¹ 5ì²œì›</div>
            </div>
            <div class="hero-ba-stats">
              <span>ê±°ì£¼ì²­ì†Œ Â· ë¶™ë°•ì´ì¥ Â· ì£¼ë°© ë‚´ë¶€ì²­ì†Œ ì„ íƒ</span>
              <span><strong>ì‹¤ì œ ìš´ì˜ ë‹¨ê°€ ê¸°ë°˜</strong></span>
            </div>
          </div>
        </div>
      </div>
    </section>
    <!-- ===============================
     ë©”ì¸ ì„¹ì…˜ ì „í™˜ ë²„íŠ¼
     =============================== -->
<div style="
  max-width:1200px;
  margin:0 auto 24px;
  padding:0 20px;
  display:flex;
  gap:10px;
  flex-wrap:wrap;
">
  <button class="tab-btn" onclick="showMainSection('estimate')">
    ğŸ§¾ ê²¬ì 
  </button>
  <button class="tab-btn" onclick="showMainSection('review')">
    â­ ê³ ê° í›„ê¸°
  </button>
  <button class="tab-btn" onclick="showMainSection('gallery')">
    ğŸ§¼ Before & After
  </button>
</div>  

    <!-- ê²¬ì  ì…ë ¥ SECTION -->
    <section class="section" id="estimate-section">
      <div class="section-title-row">
        <div>
          <div class="section-title">ìë™ ê²¬ì  ì…ë ¥</div>
          <div class="section-subtitle">
            ì‚¬ì§„ì€ ì„ íƒ ì‚¬í•­ì´ë©°, êµ¬ì¡°/í‰ìˆ˜/ì˜µì…˜ ì…ë ¥ë§Œìœ¼ë¡œë„ ê²¬ì  ì¡°íšŒê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.
          </div>
        </div>
      </div>

      <div class="estimate-grid">
        <!-- LEFT : ì…ë ¥ -->
        <div class="card">
          <div class="card-title">1. ì‚¬ì§„ ì—…ë¡œë“œ &amp; ì§‘ ì •ë³´ ì…ë ¥</div>

          <div class="upload-area">
            ì‚¬ì§„ ê²¬ì ì—ëŠ” <strong>ì˜¤ì—¼ë„ê°€ ìˆëŠ” ì‚¬ì§„ë§Œ</strong> ë„£ì–´ì£¼ì„¸ìš”.<br />
            ì‚¬ì§„ì„ ë„£ì§€ ì•Šê³ ë„ ê²¬ì  ì¡°íšŒê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.
            <input type="file" id="photoInput" accept="image/*" multiple />
          </div>

          <div class="field">
            <label for="structure">êµ¬ì¡° ì„ íƒ</label>
            <select id="structure">
              <option value="ì›ë£¸">ì›ë£¸ / ì›ë£¸ê³„ì—´</option>
              <option value="íˆ¬ë£¸">íˆ¬ë£¸</option>
              <option value="ì“°ë¦¬ë£¸">ì“°ë¦¬ë£¸</option>
              <option value="ë³µì¸µ">ë³µì¸µí˜• êµ¬ì¡°</option>
            </select>
          </div>

          <div class="field">
            <label for="supplyArea">ê³µê¸‰ í‰ìˆ˜</label>
            <input type="number" id="supplyArea" placeholder="ì˜ˆ: 23" min="1" />
            <small>22í‰ ì´í•˜: 22ë§Œì› / 23í‰ ì´ìƒ: í‰ë‹¹ 1ë§Œì› ê¸°ì¤€</small>
          </div>

          <div class="checkbox-row">
            <input type="checkbox" id="isUnexpanded" />
            <label for="isUnexpanded">ê±°ì‹¤ ë¹„í™•ì¥ (ë°œì½”ë‹ˆê°€ ê·¸ëŒ€ë¡œ ë‚¨ì•„ìˆëŠ” êµ¬ì¡°) +50,000ì›</label>
          </div>

          <div class="field">
            <label for="loftArea">ë³µì¸µ ë©´ì  (í‰)</label>
            <input type="number" id="loftArea" placeholder="ë³µì¸µ ë©´ì ì´ ì—†ë‹¤ë©´ 0" min="0" />
            <small>ë³µì¸µ ì¶”ê°€ê¸ˆ: ë³µì¸µ ë©´ì  Ã— 5,000ì›</small>
          </div>

          <div class="field">
            <label>ê±°ì£¼ì²­ì†Œ / ë¶™ë°•ì´ì¥ / ì£¼ë°© ì˜µì…˜</label>
            <!-- ğŸ“… ì²­ì†Œ ë‚ ì§œ ì„ íƒ -->
<div class="field" style="margin-top:12px;">
  <label for="cleanDate">ì²­ì†Œ ë‚ ì§œ</label>
  <input type="date" id="cleanDate" />
</div>

<!-- â° ì²­ì†Œ ì‹œê°„ ì„ íƒ -->
<div class="field">
  <label>ì²­ì†Œ ì‹œê°„</label>

  <div class="checkbox-row">
    <input type="radio" name="cleanTime" id="timeMorning" value="ì˜¤ì „ 8ì‹œ~9ì‹œ" />
    <label for="timeMorning">ì˜¤ì „ 8ì‹œ ~ 9ì‹œ</label>
  </div>

  <div class="checkbox-row">
    <input type="radio" name="cleanTime" id="timeAfternoon" value="ì˜¤í›„ 2ì‹œ~3ì‹œ" />
    <label for="timeAfternoon">ì˜¤í›„ 2ì‹œ ~ 3ì‹œ</label>
  </div>
</div>

<!-- â° ì‚¬ì´ì²­ì†Œ ì‹œê°„ (ì‚¬ì´ì²­ì†Œ ì²´í¬ ì‹œë§Œ ì‚¬ìš©) -->
<div class="field" id="sideCleanTimeBox" style="display:none;">
  <label>ì‚¬ì´ì²­ì†Œ ì‹œê°„</label>
  <div style="display:flex;gap:8px;align-items:center;">
    <input type="time" id="sideStartTime" />
    <span>~</span>
    <input type="time" id="sideEndTime" />
  </div>
</div>
<div style="margin-top:12px;font-size:12px;font-weight:600;">
  ê°€ì „ ê¸°ë³¸ì²­ì†Œ
</div>

<!-- ì—ì–´ì»¨ -->
<div class="options-row">
  <span style="font-size:12px;">ì—ì–´ì»¨ ê¸°ë³¸ì²­ì†Œ</span>
  <div class="counter">
    <button type="button" onclick="updateCounter('aircon', -1)">-</button>
    <span id="airconCount">0</span>
    <button type="button" onclick="updateCounter('aircon', 1)">+</button>
  </div>
</div>
<small>1ëŒ€ë‹¹ +20,000ì›</small>

<!-- ì„¸íƒê¸° -->
<div class="options-row" style="margin-top:6px;">
  <span style="font-size:12px;">ì„¸íƒê¸° ê¸°ë³¸ì²­ì†Œ</span>
  <div class="counter">
    <button type="button" onclick="updateCounter('washer', -1)">-</button>
    <span id="washerCount">0</span>
    <button type="button" onclick="updateCounter('washer', 1)">+</button>
  </div>
</div>
<small>1ëŒ€ë‹¹ +20,000ì›</small>

<!-- ëƒ‰ì¥ê³  -->
<div class="options-row" style="margin-top:6px;">
  <span style="font-size:12px;">ëƒ‰ì¥ê³  ê¸°ë³¸ì²­ì†Œ</span>
  <div class="counter">
    <button type="button" onclick="updateCounter('fridge', -1)">-</button>
    <span id="fridgeCount">0</span>
    <button type="button" onclick="updateCounter('fridge', 1)">+</button>
  </div>
</div>

<div class="checkbox-row" style="margin-top:4px;">
  <input type="checkbox" id="largeFridge" />
  <label for="largeFridge">ëŒ€í˜• ëƒ‰ì¥ê³  (+10,000ì› ì¶”ê°€)</label>
</div>
            <div class="checkbox-row">
              <input type="checkbox" id="isLiveIn" />
              <label for="isLiveIn">ê±°ì£¼ì²­ì†Œ (ì§ì´ ìˆëŠ” ìƒíƒœ) +50,000ì›</label>
            </div>
<!-- ì‚¬ì´ì²­ì†Œ -->
<div class="checkbox-row" style="margin-top:8px;">
  <input type="checkbox" id="sideClean" />
  <script>
document.getElementById("sideClean").addEventListener("change", function () {
  const box = document.getElementById("sideCleanTimeBox");
  box.style.display = this.checked ? "block" : "none";
});
</script>

  <label for="sideClean">ì‚¬ì´ì²­ì†Œ  +50,000ì›</label>
</div>

<!-- íŠ¹ìˆ˜ì²­ì†Œ -->
<div class="checkbox-row" style="margin-top:4px;">
  <input
    type="checkbox"
    id="specialClean"
    onchange="updateApplyButtonText()"
  />
  <label for="specialClean">
    íŠ¹ìˆ˜ì²­ì†Œ (ê°€ê²© ë³„ë„ Â· ìƒë‹´ í•„ìš”)
  </label>
</div>

<small style="font-size:11px;color:#8a94a6;">
  íŠ¹ìˆ˜ì²­ì†ŒëŠ” í˜„ì¥ ìƒíƒœì— ë”°ë¼ ìƒë‹´ í›„ ì§„í–‰ë©ë‹ˆë‹¤.
</small>            <div class="options-row">
              <span style="font-size:12px;">ë¶™ë°•ì´ì¥ 2ë„ì–´ (ë¬¸ 2ê°œ ê¸°ì¤€)</span>
              <div class="counter">
                <button type="button" onclick="updateCounter('ward2', -1)">-</button>
                <span id="ward2Count">0</span>
                <button type="button" onclick="updateCounter('ward2', 1)">+</button>
              </div>
            </div>
            <small>1ê°œë‹¹ +50,000ì›</small>

            <div class="options-row" style="margin-top:6px;">
              <span style="font-size:12px;">ë¶™ë°•ì´ì¥ 3ë„ì–´ (ë¬¸ 3ê°œ ê¸°ì¤€)</span>
              <div class="counter">
                <button type="button" onclick="updateCounter('ward3', -1)">-</button>
                <span id="ward3Count">0</span>
                <button type="button" onclick="updateCounter('ward3', 1)">+</button>
              </div>
            </div>
            <small>1ê°œë‹¹ +70,000ì›</small>

            <div class="checkbox-row" style="margin-top:8px;">
              <input type="checkbox" id="kitchenDeep" />
              <label for="kitchenDeep">ì£¼ë°© ì „ì²´ ë¹„ìš°ê³  ë‚´ë¶€ ì²­ì†Œ +70,000ì›</label>
            </div>
          </div>

          <button class="primary-btn" type="button" onclick="calculateEstimate()">
            ìë™ ë¶„ì„ &amp; ê²¬ì  ê³„ì‚°í•˜ê¸°
          </button>

          <p class="small-note">
            ì‚¬ì§„ì´ ì—†ì„ ê²½ìš°, êµ¬ì¡°Â·í‰ìˆ˜Â·ì˜µì…˜ë§Œìœ¼ë¡œ ê¸°ë³¸ ê²¬ì ì´ ê³„ì‚°ë˜ë©°<br />
            ì‚¬ì§„ì„ ì¶”ê°€í•˜ë©´ ì˜¤ì—¼ë„ì— ë”°ë¥¸ ì¶”ê°€ìš”ê¸ˆì´ í•¨ê»˜ ë°˜ì˜ë©ë‹ˆë‹¤.
          </p>
        </div>

        <!-- RIGHT : ê²°ê³¼ + ì‹ ì²­ -->
        <div class="card">
          <div class="card-title">2. ìë™ê²¬ì  ê²°ê³¼ &amp; ì‹ ì²­</div>

          <div class="result-row">
            <div class="result-summary">
              <div>
                <div style="font-size:12px;color:#8a94a6;">ì˜ˆìƒ ì´ ê²¬ì </div>
                <strong id="totalPriceText">- ì›</strong>
<div id="specialNotice" style="
  display:none;
  margin-top:6px;
  font-size:12px;
  color:#c62828;
  font-weight:600;
">
  íŠ¹ìˆ˜ì²­ì†ŒëŠ” í˜„ì¥ ìƒíƒœì— ë”°ë¼<br>
  ìƒë‹´ í›„ ê¸ˆì•¡ì´ ê²°ì •ë©ë‹ˆë‹¤.
</div>
              </div>
              <div style="font-size:11px;color:#8a94a6;text-align:right;">
                ì‚¬ì§„ ìˆ˜: <span id="photoCountText">0ì¥</span><br />
                í‰ê·  ì˜¤ì—¼ë„: <span id="avgScoreText">-</span>ì  / ìµœëŒ€ <span id="maxScoreText">-</span>ì 
              </div>
            </div>

            <table class="result-table">
              <tbody>
              <tr>
                <th class="label">êµ¬ë¶„</th>
                <th>ê¸ˆì•¡</th>
              </tr>
              <tr>
                <td class="label">ê¸°ë³¸ê°€</td>
                <td id="basePriceCell">-</td>
              </tr>
              <tr>
                <td class="label">ë¹„í™•ì¥ ì¶”ê°€</td>
                <td id="unexpCell">-</td>
              </tr>
              <tr>
                <td class="label">ë³µì¸µ ì¶”ê°€</td>
                <td id="loftCell">-</td>
              </tr>
              <tr>
                <td class="label">ê±°ì£¼/ë¶™ë°•ì´/ì‚¬ì´/ì£¼ë°© ì˜µì…˜</td>
                <td id="optionsCell">-</td>
              </tr>
              <tr>
                <td class="label">ì‚¬ì§„ ì˜¤ì—¼ë„ ì¶”ê°€ìš”ê¸ˆ í•©ê³„</td>
                <td id="photoExtraCell">-</td>
              </tr>
              </tbody>
            </table>

            <div style="margin-top:10px;">
              <div style="font-size:12px;font-weight:600;margin-bottom:4px;color:#374151;">
                ì‚¬ì§„ë³„ ì˜¤ì—¼ë„ ìƒì„¸
              </div>
              <table class="result-table" id="photoDetailTable">
                <thead>
                <tr>
                  <th>ì‚¬ì§„</th>
                  <th>ì˜¤ì—¼ë„</th>
                  <th>ë‚œì´ë„</th>
                  <th>ì¶”ê°€ìš”ê¸ˆ</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                  <td colspan="4" style="padding:10px 4px;font-size:11px;color:#8a94a6;">
                    ì‚¬ì§„ì„ ì—…ë¡œë“œí•œ ê²½ìš°, ê° ì‚¬ì§„ë³„ ì˜¤ì—¼ë„ì™€ ì¶”ê°€ìš”ê¸ˆì´ ì´ê³³ì— í‘œë¡œ í‘œì‹œë©ë‹ˆë‹¤.
                  </td>
                </tr>
                </tbody>
              </table>
            </div>

            <!-- 3. ê³ ê° ì •ë³´ ì…ë ¥ & ìë™ ì‹ ì²­ -->
            <div id="requestBox" style="margin-top:12px;padding-top:10px;border-top:1px dashed #e0e7f0;display:none;">
              <div style="font-size:13px;font-weight:600;margin-bottom:6px;color:#374151;">
                3. ê³ ê° ì •ë³´ ì…ë ¥ &amp; ê²¬ì  ì‹ ì²­
              </div>

              <div class="field">
                <label for="custName">ì´ë¦„</label>
                <input type="text" id="custName" placeholder="ì˜ˆ: í™ê¸¸" />
              </div>
              <div class="field">
                <label for="custPhone">ì—°ë½ì²˜</label>
                <input type="text" id="custPhone" placeholder="ì˜ˆ: 010-0000-0000" />
              </div>
              <div class="field">
                <label for="custAddr">ì£¼ì†Œ</label>
                <input type="text" id="custAddr" placeholder="ì˜ˆ: ìˆ˜ì›ì‹œ â—‹â—‹êµ¬ â—‹â—‹ë™ â—‹â—‹ì•„íŒŒíŠ¸" />
              </div>
              <div class="field">
                <label for="custMemo">ìš”ì²­ì‚¬í•­ (ì„ íƒ)</label>
                <input type="text" id="custMemo" placeholder="ì˜ˆ: ì…ì£¼ì²­ì†Œ / ë°˜ë ¤ë™ë¬¼ ìˆìŒ / ì‹œê°„ëŒ€ ìš”ì²­ ë“±" />
              </div>

           <button id="applyBtn" class="primary-btn" type="button" onclick="sendToKakao()">
  ìš°ìˆ˜ì—…ì²´ì—ê²Œ ìë™ ì‹ ì²­í•˜ê¸°
</button>

              <p class="small-note">
                ì‹ ì²­í•˜ê¸° ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ì¹´ì¹´ì˜¤í†¡ ì˜¤í”ˆì±„íŒ…ì´ ì—´ë¦¬ë©°,<br />
                ê²¬ì  ë‚´ìš©ì´ ë³µì‚¬ëœ ìƒíƒœì—ì„œ ìƒë‹´ì„ ì´ì–´ê°€ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
              </p>
            </div>

          </div>
        </div>
      </div>
    </section>
<!-- ===============================
     ì‹¤ì œ ì´ìš© ê³ ê° í›„ê¸°
     =============================== -->
<section class="section" id="review-section">
  <div class="section-title-row">
    <div>
      <div class="section-title">ì‹¤ì œ ì´ìš© ê³ ê° í›„ê¸°</div>
      <div class="section-subtitle">
        í´ë¦°ë©”ì´íŠ¸ë¥¼ í†µí•´ ì²­ì†Œë¥¼ ì§„í–‰í•œ ê³ ê° í›„ê¸°ì…ë‹ˆë‹¤.
      </div>
    </div>
  </div>

  <div id="publicReviewList"
       style="display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:14px;">
    <!-- JSë¡œ ë¦¬ë·° ë“¤ì–´ê° -->
  </div>
</section>

    <!-- Before & After GALLERY -->
    <section class="section" id="gallery-section">
      <div class="section-title-row">
        <div>
          <div class="section-title">Before &amp; After ê°¤ëŸ¬ë¦¬</div>
          <div class="section-subtitle">
            ì‹¤ì œ ì²­ì†Œ í˜„ì¥ì—ì„œ ì´¬ì˜í•œ ì „Â·í›„ ì‚¬ì§„ë“¤ì…ë‹ˆë‹¤. í´ë¦°ë©”ì´íŠ¸ ê¸°ì¤€ìœ¼ë¡œ ì‘ì—… ë‚œì´ë„ì™€ ê²¬ì ì„ ê³„ì‚°í•©ë‹ˆë‹¤.
          </div>
        </div>
      </div>

      <div class="ba-grid">
        <div class="ba-card">
          <img src="ba-1.webp" alt="Before & After 1" />
          <div class="ba-card-footer">
            <span>í´ë¦°ë©”ì´íŠ¸</span>
            <span class="tag"></span>
          </div>
        </div>
        <div class="ba-card">
          <img src="ba-2.webp" alt="Before & After 2" />
          <div class="ba-card-footer">
            <span>ì“°ë ˆê¸°ì§‘ ì²­ì†Œ</span>
            <span class="tag">íŠ¹ìˆ˜ ì²­ì†Œ</span>
          </div>
        </div>
        <div class="ba-card">
          <img src="ba-3.webp" alt="Before & After 3" />
          <div class="ba-card-footer">
            <span>ì‹±í¬ëŒ€ í•˜ë¶€ ë¨¼ì§€ ì œê±°</span>
            <span class="tag">ì£¼ë°© ì²­ì†Œ</span>
          </div>
        </div>
        <div class="ba-card">
          <img src="ba-4.webp" alt="Before & After 4" />
          <div class="ba-card-footer">
            <span>ìš•ì‹¤ ì„ ë°˜ ë¬¼ë•Œ ì œê±°</span>
            <span class="tag">ìˆ˜ì „/ì„¸ë©´ëŒ€</span>
          </div>
        </div>
        <div class="ba-card">
          <img src="ba-5.webp" alt="Before & After 5" />
          <div class="ba-card-footer">
            <span>ì°½í‹€ì²­ì†Œ Â· ë¨¼ì§€ ì œê±°</span>
            <span class="tag">ìƒ·ì‹œ/ì°½í‹€</span>
          </div>
        </div>
        <div class="ba-card">
          <img src="ba-6.webp" alt="Before & After 6" />
          <div class="ba-card-footer">
            <span>ë² ë€ë‹¤ ê³°íŒ¡ì´ &amp; ë¨¼ì§€ ì œê±°</span>
            <span class="tag">ë² ë€ë‹¤ ì²­ì†Œ</span>
          </div>
        </div>
        <div class="ba-card">
          <img src="ba-7.webp" alt="Before & After 7" />
          <div class="ba-card-footer">
            <span>ê°€ìŠ¤ë ˆì¸ì§€ ê¸°ë¦„ë•Œ ì œê±°</span>
            <span class="tag">ì£¼ë°© ì²­ì†Œ</span>
          </div>
        </div>
        <div class="ba-card">
          <img src="ba-8.webp" alt="Before & After 8" />
          <div class="ba-card-footer">
            <span>ìˆ˜ì „ ë¬¼ë•Œ &amp; ìŠ¤ì¼€ì¼ ì œê±°</span>
            <span class="tag">ìš•ì‹¤ ì²­ì†Œ</span>
          </div>
        </div>
      </div>
    </section>
    
  </main>

  <!-- FOOTER -->
  <footer>
    <div class="footer-inner">
      <div>
        <strong>CleanMate</strong> Â· ì²­ì†Œ ê²¬ì  ìë™ ê³„ì‚° ì„œë¹„ìŠ¤<br />
        ì‚¬ì—…ììš©/íŒŒíŠ¸ë„ˆìš© ê³„ì •ì€ ë³„ë„ ë¬¸ì˜ ë°”ëë‹ˆë‹¤.
      </div>
      <div>
        Â© CleanMate. All rights reserved.
      </div>
    </div>
  </footer>

</div>
<!-- ===============================
     ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ (ìˆ¨ê¹€)
     =============================== -->
<div id="adminDashboard" style="
  display:none;
  position:fixed;
  inset:0;
  background:#f5f7fb;
  z-index:9998;
  overflow:auto;
">
  <div style="max-width:1200px;margin:20px auto;padding:20px;">

  <!-- ê´€ë¦¬ì ì œëª© -->
  <div style="
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding-bottom:12px;
    border-bottom:1px solid #ddd;
  ">
    <div>
      <h2 style="margin:0;">CleanMate ê´€ë¦¬ì</h2>
      <div style="font-size:12px;color:#666;">
        ê²¬ì  Â· ê³ ê° Â· ì—…ì²´ Â· ë¦¬ë·° í†µí•© ê´€ë¦¬
      </div>
    </div>
    <button onclick="closeAdminDashboard()"
      style="padding:8px 14px;border-radius:8px;border:1px solid #ccc;">
      ë‹«ê¸°
    </button>
  </div>

  <!-- ğŸ”¥ í†µê³„ ì¹´ë“œ (ì—¬ê¸°ê°€ í•µì‹¬) -->
  <div id="adminStats" style="
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
    gap:12px;
    margin:16px 0 20px;
  ">
    <div style="background:#fff;border-radius:14px;padding:14px;box-shadow:0 6px 18px rgba(0,0,0,0.06);">
      <b>ëˆ„ì  ê²¬ì  ìš”ì²­</b><br>
      <span id="statTotalOrders">-</span> ê±´
    </div>

    <div style="background:#fff;border-radius:14px;padding:14px;box-shadow:0 6px 18px rgba(0,0,0,0.06);">
      <b>ì‹¤ì œ ê³ ê° ìˆ˜</b><br>
      <span id="statCustomers">-</span> ëª…
    </div>

    <div style="background:#fff;border-radius:14px;padding:14px;box-shadow:0 6px 18px rgba(0,0,0,0.06);">
      <b>ì‹¤ì œ ë°°ì • ì™„ë£Œ ê±´</b><br>
      <span id="statCompleted">-</span> ê±´
    </div>

    <div style="background:#fff;border-radius:14px;padding:14px;box-shadow:0 6px 18px rgba(0,0,0,0.06);">
      <b>í‰ê·  ê°ë‹¨ê°€</b><br>
      <span id="statAvgPrice">-</span> ì›
    </div>

    <div style="background:#fff;border-radius:14px;padding:14px;box-shadow:0 6px 18px rgba(0,0,0,0.06);">
      <b>ê³ ë¶€ê°€ íŠ¹ìˆ˜ì²­ì†Œ ë¹„ì¤‘</b><br>
      <span id="statSpecial">-</span> ê±´
    </div>
  </div>

  <!-- ê´€ë¦¬ì íƒ­ ë²„íŠ¼ -->
  <div style="margin-top:20px;display:flex;gap:12px;">
    <button onclick="showAdminTab('reviews')">â­ ë¦¬ë·° ê´€ë¦¬</button>
    <button onclick="showAdminTab('companies')">ğŸ¢ ì—…ì²´ ê´€ë¦¬</button>
    <button onclick="showAdminTab('customers')">ğŸ‘¤ ê³ ê° ê´€ë¦¬</button>
    <button onclick="showAdminTab('orders')">ğŸ“‹ ì˜ˆì•½ ê´€ë¦¬</button>
  </div>

  <!-- íƒ­ ì½˜í…ì¸  -->
  <div id="adminContent" style="margin-top:20px;"></div>

</div>
</div>

<script>
const ORDER_STEPS = [
  "ì ‘ìˆ˜ë¨",
  "ë°°ì •ì™„ë£Œ",
  "ë°˜ë ¤ë¨"
];

let customers = [];

function renderStatusFlow(currentStatus) {
  const currentIndex = ORDER_STEPS.indexOf(currentStatus);

  return `
    <div style="display:flex;gap:6px;margin-top:8px;">
      ${ORDER_STEPS.map((step, idx) => {
        let bg = "#eee";
        let color = "#999";

        if (idx < currentIndex) {
          bg = "#e3f2fd";     // ì™„ë£Œ(ì§€ë‚˜ê°„ ë‹¨ê³„)
          color = "#1565c0";
        } else if (idx === currentIndex) {
          bg = "#0288d1";     // í˜„ì¬ ë‹¨ê³„
          color = "#fff";
        }

        return `
          <div style="
            flex:1;
            text-align:center;
            padding:6px 0;
            border-radius:999px;
            font-size:11px;
            font-weight:600;
            background:${bg};
            color:${color};
          ">
            ${step}
          </div>
        `;
      }).join("")}
    </div>
  `;
}

/* ===============================
   ê³ ê° ë°ì´í„° (ê´€ë¦¬ì ì „ìš©)
   =============================== */

function updateApplyButtonText() {
  const isSpecial = document.getElementById("specialClean").checked;
  const btn = document.getElementById("applyBtn");

  if (!btn) return;

  if (isSpecial) {
    btn.textContent = "íŠ¹ìˆ˜ì²­ì†Œ ìƒë‹´ ì‹ ì²­í•˜ê¸°";
  } else {
    btn.textContent = "ìš°ìˆ˜ì—…ì²´ì—ê²Œ ìë™ ì‹ ì²­í•˜ê¸°";
  }
}

  function formatPrice(num) {
    if (num === 0) return "0ì›";
    if (!num) return "-";
    return num.toLocaleString("ko-KR") + "ì›";
  }

  function scrollToEstimate() {
    const el = document.getElementById("estimate-section");
    if (el) el.scrollIntoView({ behavior: "smooth", block: "start" });
  }

/* âœ… ë©”ì¸ ì„¹ì…˜ íƒ­ ì „í™˜ */
function showMainSection(type){

  // 1ï¸âƒ£ ì „ë¶€ ìˆ¨ê¹€
  document.getElementById("estimate-section").style.display = "none";
  document.getElementById("review-section").style.display = "none";
  document.getElementById("gallery-section").style.display = "none";

  // 2ï¸âƒ£ ë²„íŠ¼ active ì œê±°
  document.querySelectorAll(".tab-btn").forEach(btn => {
    btn.classList.remove("active");
  });

  // 3ï¸âƒ£ ì„ íƒí•œ ê²ƒë§Œ ë³´ì—¬ì£¼ê¸°
  if(type === "estimate"){
    document.getElementById("estimate-section").style.display = "block";
    document.querySelectorAll(".tab-btn")[0].classList.add("active");
  }

  if(type === "review"){
    document.getElementById("review-section").style.display = "block";
    document.querySelectorAll(".tab-btn")[1].classList.add("active");
  }

  if(type === "gallery"){
    document.getElementById("gallery-section").style.display = "block";
    document.querySelectorAll(".tab-btn")[2].classList.add("active");
  }
}

/* âœ… ì²˜ìŒ í™”ë©´ì€ ê²¬ì ë§Œ */
document.addEventListener("DOMContentLoaded", () => {
  showMainSection("estimate");
});
function goMyPage() {
  window.location.href = "mypage.html";
}
 function updateCounter(type, delta) {
  let id = "";

  if (type === "ward2") id = "ward2Count";
  if (type === "ward3") id = "ward3Count";
  if (type === "aircon") id = "airconCount";
  if (type === "washer") id = "washerCount";
  if (type === "fridge") id = "fridgeCount";

  const el = document.getElementById(id);
  if (!el) return;

  let val = parseInt(el.textContent || "0", 10);
  val += delta;
  if (val < 0) val = 0;
  el.textContent = String(val);
}

  function calculateEstimate() {
    const structure = document.getElementById("structure").value;
    const supplyArea = parseFloat(document.getElementById("supplyArea").value || "0");
    const isUnexpanded = document.getElementById("isUnexpanded").checked;
    const loftArea = parseFloat(document.getElementById("loftArea").value || "0");
    const isLiveIn = document.getElementById("isLiveIn").checked;
    const ward2Count = parseInt(document.getElementById("ward2Count").textContent || "0", 10);
    const ward3Count = parseInt(document.getElementById("ward3Count").textContent || "0", 10);
    const kitchenDeep = document.getElementById("kitchenDeep").checked;
const sideClean = document.getElementById("sideClean").checked;
const specialClean = document.getElementById("specialClean").checked;
const specialNotice = document.getElementById("specialNotice");
updateApplyButtonText();

    // ì‚¬ì§„ ìˆ˜ & ëœë¤ ì˜¤ì—¼ë„
    const files = document.getElementById("photoInput").files;
    const photoCount = files.length;
    let scores = [];

    if (photoCount > 0) {
      for (let i = 0; i < photoCount; i++) {
        // 40~95 ì‚¬ì´ ëœë¤ (í˜„ì¬ëŠ” ìƒ˜í”Œìš©)
        const score = Math.floor(40 + Math.random() * 56);
        scores.push(score);
      }
    }

    const avgScore = scores.length
      ? Math.round(scores.reduce((a, b) => a + b, 0) / scores.length)
      : null;
    const maxScore = scores.length ? Math.max(...scores) : null;

    // 1) ê¸°ë³¸ê°€
    let basePrice = 0;
    if (structure === "ì›ë£¸") {
      basePrice = 160000;
    } else {
      if (supplyArea <= 0) {
        basePrice = 0;
      } else if (supplyArea <= 22) {
        basePrice = 220000;
      } else {
        basePrice = supplyArea * 10000;
      }
    }

    // 2) ë¹„í™•ì¥ + ë³µì¸µ
    const unexpAdd = isUnexpanded ? 50000 : 0;
    const loftAdd = loftArea > 0 ? loftArea * 5000 : 0;

    // 3) ê±°ì£¼ / ë¶™ë°•ì´ / ì£¼ë°©
    let optionsAdd = 0;
    const airconCount = parseInt(document.getElementById("airconCount").textContent || "0", 10);
const washerCount = parseInt(document.getElementById("washerCount").textContent || "0", 10);
const fridgeCount = parseInt(document.getElementById("fridgeCount").textContent || "0", 10);
const largeFridge = document.getElementById("largeFridge").checked;

optionsAdd += airconCount * 20000;
optionsAdd += washerCount * 20000;
optionsAdd += fridgeCount * 20000;

if (largeFridge && fridgeCount > 0) {
  optionsAdd += fridgeCount * 10000;
}
if (sideClean) optionsAdd += 50000;
    if (isLiveIn) optionsAdd += 50000;
    optionsAdd += ward2Count * 50000;
    optionsAdd += ward3Count * 70000;
    if (kitchenDeep) optionsAdd += 70000;

    // 4) ì‚¬ì§„ë³„ ì˜¤ì—¼ë„ ì¶”ê°€ìš”ê¸ˆ (ë³´í†µ ë”ëŸ¬ì›€ 0ì›)
    //    0~60 : 0ì›
    //    61~75 : +10,000ì›
    //    76~90 : +30,000ì›
    //    91~100: +50,000ì›
    let photoExtraTotal = 0;
    let detailRowsHtml = "";

    if (scores.length) {
      scores.forEach((score, idx) => {
        let extra = 0;
        let level = "ë³´í†µ";
        if (score > 60 && score <= 75) {
          extra = 10000;
          level = "ì•½ê°„ ë†’ìŒ";
        } else if (score > 75 && score <= 90) {
          extra = 30000;
          level = "ë†’ìŒ";
        } else if (score > 90) {
          extra = 50000;
          level = "ë§¤ìš° ë†’ìŒ";
        }
        photoExtraTotal += extra;

        detailRowsHtml += `
          <tr>
            <td>${idx + 1}ë²ˆ</td>
            <td>${score}ì </td>
            <td>${level}</td>
            <td>${extra ? "+" + extra.toLocaleString("ko-KR") + "ì›" : "0ì›"}</td>
          </tr>
        `;
      });
    } else {
      detailRowsHtml = `
        <tr>
          <td colspan="4" style="padding:10px 4px;font-size:11px;color:#8a94a6;">
            ì‚¬ì§„ì„ ì—…ë¡œë“œí•œ ê²½ìš°, ê° ì‚¬ì§„ë³„ ì˜¤ì—¼ë„ì™€ ì¶”ê°€ìš”ê¸ˆì´ í‘œì‹œë©ë‹ˆë‹¤.
          </td>
        </tr>
      `;
    }

    const total = basePrice + unexpAdd + loftAdd + optionsAdd + photoExtraTotal;

    // í™”ë©´ ë°˜ì˜
    document.getElementById("photoCountText").textContent = photoCount + "ì¥";
    document.getElementById("avgScoreText").textContent = avgScore !== null ? avgScore : "-";
    document.getElementById("maxScoreText").textContent = maxScore !== null ? maxScore : "-";

    document.getElementById("basePriceCell").textContent = formatPrice(basePrice);
    document.getElementById("unexpCell").textContent = formatPrice(unexpAdd);
    document.getElementById("loftCell").textContent = formatPrice(loftAdd);
    document.getElementById("optionsCell").textContent = formatPrice(optionsAdd);
    document.getElementById("photoExtraCell").textContent = formatPrice(photoExtraTotal);
    if (specialClean) {
  document.getElementById("totalPriceText").textContent = "ìƒë‹´ í›„ ê²°ì •";
  specialNotice.style.display = "block";
} else {
  document.getElementById("totalPriceText").textContent = formatPrice(total);
  specialNotice.style.display = "none";
}

    const tbody = document.querySelector("#photoDetailTable tbody");
    tbody.innerHTML = detailRowsHtml;

    // ê³„ì‚° í›„ ì‹ ì²­ ë°•ìŠ¤ ì˜¤í”ˆ
    document.getElementById("requestBox").style.display = "block";
  }

async function sendToKakao() {
  const specialClean = document.getElementById("specialClean").checked;

  const name = (document.getElementById("custName").value || "").trim();
  const phone = (document.getElementById("custPhone").value || "").trim();
  const addr = (document.getElementById("custAddr").value || "").trim();
  const memo = (document.getElementById("custMemo").value || "").trim();
  const cleanDate = document.getElementById("cleanDate").value;

let cleanTime = "";
const timeMorning = document.getElementById("timeMorning").checked;
const timeAfternoon = document.getElementById("timeAfternoon").checked;

if (timeMorning) cleanTime = "ì˜¤ì „ 8ì‹œ~9ì‹œ";
if (timeAfternoon) cleanTime = "ì˜¤í›„ 2ì‹œ~3ì‹œ";

const sideCleanChecked = document.getElementById("sideClean").checked;
let sideCleanTime = "";

if (sideCleanChecked) {
  const start = document.getElementById("sideStartTime").value;
  const end = document.getElementById("sideEndTime").value;
  sideCleanTime = start && end ? `${start} ~ ${end}` : "";
}

  if (!name || !phone) {
    alert("ì´ë¦„ê³¼ ì—°ë½ì²˜ëŠ” í•„ìˆ˜ ì…ë ¥ì…ë‹ˆë‹¤.");
    return;
  }

  /* ===============================
     1ï¸âƒ£ ê³ ê° upsert (Supabase)
     =============================== */
const { data: customerData, error: customerError } =
  await supabaseClient
    .from("customers")
    .upsert(
      {
        name,
        phone,
        address: addr,
        memo,
      },
      { onConflict: "phone" }
    )
    .select()
    .single();
console.log("customerData:", customerData);
console.log("customerError:", customerError);
if (customerError) {
  console.error(customerError);
  alert("ê³ ê° ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
  return;
}

  /* ===============================
     2ï¸âƒ£ ì£¼ë¬¸ ì €ì¥ (ê³ ê° ì—°ê²°)
     =============================== */
  const structure = document.getElementById("structure").value;
  const supplyAreaInput = document.getElementById("supplyArea").value;
const supplyArea = supplyAreaInput ? Number(supplyAreaInput) : null;
  const totalPrice = document.getElementById("totalPriceText").textContent || "-";
  const priceText = totalPrice;
const priceNumber = priceText.includes("ì›")
  ? parseInt(priceText.replace(/[^\d]/g, ""), 10)
  : null;
 
  const photoCountText = document.getElementById("photoCountText").textContent || "-";
  const avgScoreText = document.getElementById("avgScoreText").textContent || "-";
  const maxScoreText = document.getElementById("maxScoreText").textContent || "-";

  const { error: orderError } = await supabaseClient
  .from("orders")
.insert([{
  name,
  phone,
  address: addr,
  memo,
  structure,
  supply_area: supplyArea,
  estimated_price_text: totalPrice,
  estimated_price_number: priceNumber, // â­ ì¶”ê°€
  clean_date: cleanDate,
  clean_time: cleanTime,
  side_clean_time: sideCleanTime || null,
  status: "ì ‘ìˆ˜ë¨"
}]);

if (orderError) {
  console.error(orderError);
  alert("ì˜ˆì•½ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
  return;
}

  const payload = {
  name,
  phone,
  address: addr,
  memo,
  clean_date: cleanDate,
  clean_time: cleanTime,
  side_clean_time: sideCleanTime || null,
  structure,
  supply_area: supplyArea,
  total_price_text: document.getElementById("totalPriceText").textContent
};

localStorage.setItem("cleanmate_payload", JSON.stringify(payload));

// í•„ìˆ˜ í™•ì¸ í˜ì´ì§€ë¡œ ì´ë™
window.location.href = "confirm.html";
  
}
  
</script>
<!-- ===============================
     ê´€ë¦¬ì ë¡œê·¸ì¸ ëª¨ë‹¬
     =============================== -->
  <script>
let adminClickCount = 0;
let adminClickTimer = null;

window.addEventListener("load", () => {
  const footer = document.getElementsByTagName("footer")[0];
  if (!footer) {
    alert("footer ëª» ì°¾ìŒ");
    return;
  }

  footer.onclick = () => {
    adminClickCount++;

    if (adminClickCount === 1) {
      adminClickTimer = setTimeout(() => {
        adminClickCount = 0;
      }, 5000);
    }

    if (adminClickCount === 5) {
      clearTimeout(adminClickTimer);
      adminClickCount = 0;
      document.getElementById("adminModal").style.display = "block";
    }
  };
});
</script>
<div id="adminModal" style="
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.6);
  z-index:9999;
">
  <div style="
    background:#fff;
    max-width:360px;
    margin:15% auto;
    padding:24px;
    border-radius:12px;
  ">
    <h3 style="text-align:center;margin-bottom:16px;">
      CleanMate ê´€ë¦¬ì ë¡œê·¸ì¸
    </h3>

<input id="adminEmail" type="text" placeholder="ê´€ë¦¬ì ì•„ì´ë””"
  style="width:100%;padding:10px;margin-bottom:10px;" />

    <input id="adminPassword" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸"
      style="width:100%;padding:10px;margin-bottom:16px;" />

<button onclick="adminLogin()"
  style="width:100%;padding:12px;background:#111;color:#fff;border:none;">
  ë¡œê·¸ì¸
</button>

    <button onclick="closeAdminModal()"
      style="width:100%;margin-top:8px;padding:10px;">
      ì·¨ì†Œ
    </button>
  </div>
</div>

<script>
/* ===============================
   ê´€ë¦¬ì ì§„ì… íŠ¸ë¦¬ê±° (í‘¸í„° 5ë²ˆ í´ë¦­)
   =============================== */
/* ===============================
   ì—…ì²´ ë°ì´í„° (ê´€ë¦¬ì ì „ìš©)
   =============================== */
let companies = [
  {
    name: "í™˜ìŠ¹í´ë¦°",
    desc: "í´ë¦°ë©”ì´íŠ¸ ê²€ì¦ 1í˜¸ ì²­ì†Œì—…ì²´",
    rating: 5,
    visible: true,
    image: ""
  }
];

/* ===============================
   ë¦¬ë·° ë°ì´í„° (ê´€ë¦¬ì ì „ìš©)
   =============================== */
  let reviews = [];
  let adminReviews = [];
let publicReviews = [];
  async function loadAdminReviews() {
  const { data, error } = await supabaseClient
    .from("reviews")
    .select("*")
    .order("created_at", { ascending: false });

  if (error) {
    console.error(error);
    alert("ë¦¬ë·° ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.");
    return;
  }

  adminReviews = data || [];
  renderReviews();
}

async function loadPublicReviews() {
  const { data, error } = await supabaseClient
    .from("reviews")
    .select("*")
    .eq("visible", true)
    .order("created_at", { ascending: false });

  if (error) {
    console.error(error);
    return;
  }

  publicReviews = data || [];
  renderPublicReviews();
  renderBAGallery();
}
  
let adminReviewScore = null;

function selectAdminReviewScore(score){
  adminReviewScore = score;
  alert(
    score === 5 ? "ë„ˆë¬´ ë§Œì¡±í•´ìš” ì„ íƒë¨" :
    score === 4 ? "ë§Œì¡±í•´ìš” ì„ íƒë¨" :
    "ì•„ì‰¬ì›Œìš” ì„ íƒë¨"
  );
}

function checkAdminReviewPhotos(){
  const input = document.getElementById("reviewPhotos");
  if (!input) return;

  if (input.files.length > 10) {
    alert("ì‚¬ì§„ì€ ìµœëŒ€ 10ì¥ê¹Œì§€ë§Œ ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
    input.value = "";
  }
}
/* ===============================
   ê´€ë¦¬ì ë¡œê·¸ì¸ 
   =============================== */
function adminLogin() {
  const email = document.getElementById("adminEmail").value;
  const password = document.getElementById("adminPassword").value;

  if (email === "clean8904" && password === "ghkstmdzmffls8904!") {
    openAdminDashboard();
  } else {
    alert("ê´€ë¦¬ì ë¡œê·¸ì¸ ì‹¤íŒ¨");
  }
}

function closeAdminModal() {
  document.getElementById("adminModal").style.display = "none";
}

/* ===============================
   ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ ì œì–´
   =============================== */
function openAdminDashboard() {
  document.getElementById("adminModal").style.display = "none";
  document.getElementById("adminDashboard").style.display = "block";
  loadAdminStats();  
  showAdminTab("reviews"); 
}

function closeAdminDashboard() {
  document.getElementById("adminDashboard").style.display = "none";
}
/* ===============================
   ê´€ë¦¬ì ì£¼ë¬¸ ê´€ë¦¬
   =============================== */
  async function loadAdminStats() {
  // 1ï¸âƒ£ ì „ì²´ ì£¼ë¬¸ ìˆ˜
  const { count: totalOrders } = await supabaseClient
    .from("orders")
    .select("*", { count: "exact", head: true });

  // 2ï¸âƒ£ ê³ ê° ìˆ˜
  const { count: totalCustomers } = await supabaseClient
    .from("customers")
    .select("*", { count: "exact", head: true });

  // 3ï¸âƒ£ ë°°ì • ì™„ë£Œ ì£¼ë¬¸
  const { count: completedOrders } = await supabaseClient
    .from("orders")
    .select("*", { count: "exact", head: true })
    .eq("status", "ë°°ì •ì™„ë£Œ");
    
// 4ï¸âƒ£ í‰ê·  ê°ë‹¨ê°€ 
const { data: priceData, error: priceError } =
  await supabaseClient
    .from("orders")
    .select("estimated_price_number")
    .not("estimated_price_number", "is", null);

let avgPrice = "-";

if (!priceError && priceData.length > 0) {
  const sum = priceData.reduce(
    (acc, cur) => acc + cur.estimated_price_number,
    0
  );
  avgPrice = Math.round(sum / priceData.length).toLocaleString("ko-KR");
}

// 5ï¸âƒ£ íŠ¹ìˆ˜ì²­ì†Œ ë¹„ì¤‘ 
const specialCount = "-";

  // í™”ë©´ ë°˜ì˜
  document.getElementById("statTotalOrders").textContent = totalOrders ?? "-";
  document.getElementById("statCustomers").textContent = totalCustomers ?? "-";
  document.getElementById("statCompleted").textContent = completedOrders ?? "-";
  document.getElementById("statAvgPrice").textContent = avgPrice;
  document.getElementById("statSpecial").textContent = specialCount ?? "-";
}
  async function loadCustomers() {
  // 1ï¸âƒ£ ê³ ê° ëª©ë¡
  const { data: customerData, error: customerError } =
    await supabaseClient
      .from("customers")
      .select("*")
      .order("created_at", { ascending: false });

  if (customerError) {
    console.error(customerError);
    return;
  }

  // 2ï¸âƒ£ ì£¼ë¬¸ ëª©ë¡ (ì´ìš© íšŸìˆ˜ ê³„ì‚°ìš©)
  const { data: orderData, error: orderError } =
    await supabaseClient
      .from("orders")
      .select("phone");

  if (orderError) {
    console.error(orderError);
    return;
  }

  // 3ï¸âƒ£ ì „í™”ë²ˆí˜¸ë³„ ì´ìš© íšŸìˆ˜ ê³„ì‚°
  const orderCountMap = {};
  orderData.forEach(o => {
    if (!o.phone) return;
    orderCountMap[o.phone] = (orderCountMap[o.phone] || 0) + 1;
  });

  // 4ï¸âƒ£ ê³ ê° + ì´ìš©íšŸìˆ˜ í•©ì¹˜ê¸°
  customers = customerData.map(c => ({
    id: c.id,
    name: c.name,
    phone: c.phone,
    address: c.address,
    memo: c.memo || "",
    count: orderCountMap[c.phone] || 0
  }));

  renderCustomers();
}
  async function updateOrderStatus(orderId, newStatus) {
  let updateData = {};

  if (newStatus === "ì…ê¸ˆí™•ì¸") {
    updateData.status = "ë°°ì •ì™„ë£Œ";
    updateData.assigned_company = "í™˜ìŠ¹í´ë¦°";
  } else {
    updateData.status = newStatus;
  }

  const { error } = await supabaseClient
    .from("orders")
    .update(updateData)
    .eq("id", orderId);

  if (error) {
    alert("ìƒíƒœ ë³€ê²½ ì‹¤íŒ¨");
    console.error(error);
    return;
  }

  loadOrders();
}
  function renderNextActionButtons(order) {

  if (order.status === "ë°˜ë ¤ë¨") {
    return `
      <span style="font-size:12px;color:#c62828;font-weight:600;">
        ê³ ê° ë°˜ë ¤ë¨
      </span>
      <button
        style="margin-left:6px;color:#c62828;"
        onclick="deleteOrder('${order.id}')"
      >
        âŒ ì‚­ì œ
      </button>
    `;
  }

  let buttons = "";

  if (order.status === "ì ‘ìˆ˜ë¨") {
    buttons += `
      <button onclick="updateOrderStatus('${order.id}', 'ì…ê¸ˆí™•ì¸')">
        ğŸ’° ì…ê¸ˆí™•ì¸
      </button>
      <button onclick="rejectOrder('${order.id}')">
        â†© ê³ ê°ë°˜ë ¤
      </button>
    `;
  }

 if (order.status === "ì ‘ìˆ˜ë¨") {
    buttons += `
      <button onclick="updateOrderStatus('${order.id}', 'ë°°ì •ì™„ë£Œ')">
        âœ… ë°°ì •ì™„ë£Œ
      </button>
    `;
  }

  buttons += `
    <button
      style="color:#c62828;"
      onclick="deleteOrder('${order.id}')"
    >
      âŒ ì‚­ì œ
    </button>
  `;

  return buttons;
}
  async function rejectOrder(orderId) {
  const reason = prompt(
    "ë°˜ë ¤ ì‚¬ìœ ë¥¼ ì…ë ¥í•˜ì„¸ìš”.\nì˜ˆ: ì „í™”ë²ˆí˜¸ ì˜¤ë¥˜ / ì£¼ì†Œ ë¶ˆëª…í™•"
  );

  if (!reason) return;

  const { error } = await supabaseClient
    .from("orders")
    .update({
      status: "ë°˜ë ¤ë¨",
      memo: reason
    })
    .eq("id", orderId);

  if (error) {
    alert("ë°˜ë ¤ ì²˜ë¦¬ ì‹¤íŒ¨");
    console.error(error);
    return;
  }

  loadOrders();
}

async function deleteOrder(orderId) {
  if (!confirm("ì´ ì˜ˆì•½ì„ ì™„ì „íˆ ì‚­ì œí• ê¹Œìš”?\n(ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤)")) {
    return;
  }

  const { error } = await supabaseClient
    .from("orders")
    .delete()
    .eq("id", orderId);

  if (error) {
    alert("ì‚­ì œ ì‹¤íŒ¨");
    console.error(error);
    return;
  }

  loadOrders();
}

async function loadOrders() {
  const list = document.getElementById("orderList");
  if (!list) return;

  list.innerHTML = "ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...";

  const { data, error } = await supabaseClient
    .from("orders")
    .select("*")
    .order("created_at", { ascending: false });

  if (error) {
    list.innerHTML = "ì˜ˆì•½ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.";
    console.error(error);
    return;
  }

  if (!data || data.length === 0) {
    list.innerHTML = "ì˜ˆì•½ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.";
    return;
  }

  list.innerHTML = data.map(order => `
  <div style="
    background:#fff;
    border-radius:12px;
    padding:14px;
    margin-bottom:12px;
    box-shadow:0 6px 18px rgba(0,0,0,0.06);
    font-size:13px;
  ">
    <div style="font-weight:700;">
      ${order.name} (${order.phone})
    </div>
<button
  style="
    margin-top:6px;
    padding:6px 10px;
    border-radius:6px;
    border:1px solid #0288d1;
    background:#fff;
    color:#0288d1;
    font-size:12px;
    cursor:pointer;
    font-weight:600;
  "
  onclick="
    window.selectedOrderId='${order.id}';
    document.getElementById('selectedOrderInfo').innerText =
      'ì„ íƒëœ ì£¼ë¬¸: ${order.name} (${order.phone})';
      document.getElementById("addReviewBtn").disabled = false;
  "
>
  ğŸ“ ë¦¬ë·° ì„ íƒ
</button>

<div style="margin-top:6px;color:#555;">
  ì£¼ì†Œ: ${order.address || "-"}<br>
  êµ¬ì¡°/í‰ìˆ˜: ${order.structure || "-"} / ${order.supply_area ?? "-"}í‰<br>
  ìƒíƒœ: <b>${order.status}</b><br>
  ì²­ì†Œì¼: ${order.clean_date || "-"}<br>
ì‹œê°„: ${order.clean_time || "-"}<br>
${order.side_clean_time ? `ì‚¬ì´ì²­ì†Œ ì‹œê°„: ${order.side_clean_time}<br>` : ""}
  ${order.assigned_company ? `ë°°ì •ì—…ì²´: <b>${order.assigned_company}</b><br>` : ""}
</div>

    ${
      order.status === "ë°˜ë ¤ë¨" && order.memo
        ? `
        <div style="
          margin-top:8px;
          padding:8px;
          border-radius:8px;
          background:#fdecea;
          color:#c62828;
          font-size:12px;
          font-weight:600;
        ">
          ğŸ“Œ ë°˜ë ¤ ì‚¬ìœ : ${order.memo}
        </div>
        `
        : ""
    }

    <div style="margin-top:10px;">
      ${renderNextActionButtons(order)}
    </div>

    <div style="margin-top:6px;font-size:11px;color:#888;">
      ì ‘ìˆ˜ì¼: ${new Date(order.created_at).toLocaleString("ko-KR")}
    </div>
  </div>
`).join("");
}
  
  
let orderAutoRefreshTimer = null;

function showAdminTab(tab) {
  const box = document.getElementById("adminContent");
    // ì˜ˆì•½ ê´€ë¦¬ íƒ­ì´ ì•„ë‹ˆë©´ ìë™ ìƒˆë¡œê³ ì¹¨ ì¤‘ì§€
  if (tab !== "orders" && orderAutoRefreshTimer) {
    clearInterval(orderAutoRefreshTimer);
    orderAutoRefreshTimer = null;
  }
  /* ===============================
     ê³ ê° ê´€ë¦¬
     =============================== */
 if (tab === "customers") {
  box.innerHTML = `
    <h3>ğŸ‘¤ ê³ ê° ê´€ë¦¬</h3>
    <div id="customerList" style="margin-top:16px;"></div>
  `;

  loadCustomers();
  return;
}
  /* ===============================
     ì˜ˆì•½ ê´€ë¦¬
     =============================== */
if (tab === "orders") {
  box.innerHTML = `
    <h3>ğŸ“‹ ì˜ˆì•½ ê´€ë¦¬</h3>
    <div id="orderList" style="margin-top:16px;"></div>
  `;

  // ê¸°ì¡´ íƒ€ì´ë¨¸ ìˆìœ¼ë©´ ì œê±°
  if (orderAutoRefreshTimer) {
    clearInterval(orderAutoRefreshTimer);
    orderAutoRefreshTimer = null;
  }

  // ìµœì´ˆ 1íšŒ ë¡œë“œ
  loadOrders();


  orderAutoRefreshTimer = setInterval(() => {
    loadOrders();
  }, 5000);

  return;
}

  /* ===============================
     ì—…ì²´ ê´€ë¦¬
     =============================== */
  if (tab === "companies") {
    box.innerHTML = `
      <h3>ğŸ¢ ì—…ì²´ ê´€ë¦¬</h3>

      <div style="margin-top:12px;padding:12px;border:1px solid #ddd;border-radius:8px;">
        <h4>ì—…ì²´ ì¶”ê°€</h4>

        <input id="companyName" placeholder="ì—…ì²´ëª…"
          style="width:100%;padding:8px;margin-bottom:6px;" />

        <input id="companyDesc" placeholder="ê°„ë‹¨ ì†Œê°œê¸€"
          style="width:100%;padding:8px;margin-bottom:6px;" />

        <input id="companyImage" placeholder="ëŒ€í‘œ ì´ë¯¸ì§€ URL (ì„ íƒ)"
          style="width:100%;padding:8px;margin-bottom:6px;" />

        <button onclick="addCompany()">ì—…ì²´ ì¶”ê°€</button>
      </div>

      <div id="companyList" style="margin-top:16px;"></div>
    `;
    renderCompanies();
    return;
  }

 /* ===============================
     ë¦¬ë·° ê´€ë¦¬
     =============================== */
if (tab === "reviews") {
  box.innerHTML = `
    <h3>â­ ë¦¬ë·° ê´€ë¦¬</h3>
    <div id="selectedOrderInfo"
     style="margin:6px 0;font-size:12px;color:#0288d1;font-weight:600;">
  ì„ íƒëœ ì£¼ë¬¸ ì—†ìŒ
</div>

    <div style="margin-top:12px;padding:12px;border:1px solid #ddd;border-radius:8px;">
      <h4>ë¦¬ë·° ì¶”ê°€</h4>

      <!-- ë§Œì¡±ë„ ë²„íŠ¼(3ê°œ) -->
      <div style="display:flex;gap:6px;margin-bottom:10px;">
        <button type="button" class="review-btn" onclick="selectAdminReviewScore(5)">ğŸ˜Š ë„ˆë¬´ ë§Œì¡±í•´ìš”</button>
        <button type="button" class="review-btn" onclick="selectAdminReviewScore(4)">ğŸ™‚ ë§Œì¡±í•´ìš”</button>
        <button type="button" class="review-btn" onclick="selectAdminReviewScore(2)">ğŸ˜ ì•„ì‰¬ì›Œìš”</button>
      </div>

      <input id="reviewAuthor" placeholder="ì‘ì„±ì(ì˜ˆ: ê¹€**)"
        style="width:100%;padding:8px;margin-bottom:6px;" />

      <textarea id="reviewText" placeholder="ë¦¬ë·° ë‚´ìš©"
        style="width:100%;padding:8px;height:80px;margin-bottom:6px;"></textarea>

      <!-- ğŸ“¸ ì‚¬ì§„ ì—…ë¡œë“œ -->
      <div style="margin:8px 0;">
        <div style="font-size:13px;font-weight:600;margin-bottom:4px;">
          í›„ê¸° ì‚¬ì§„ ì—…ë¡œë“œ (ìµœëŒ€ 10ì¥)
        </div>
        <input
          id="reviewPhotos"
          type="file"
          accept="image/*"
          multiple
          onchange="checkAdminReviewPhotos()"
        />
      </div>

      <button
  onclick="addReview()"
  id="addReviewBtn"
  disabled
>
  ë¦¬ë·° ì¶”ê°€
</button>
    </div>

    <div id="reviewList" style="margin-top:16px;"></div>
  `;

  loadAdminReviews();

  return;
}
}

function renderReviews() {
  const list = document.getElementById("reviewList");
  if (!list) return;

  list.innerHTML = adminReviews.map((r, i) => `
    <div style="border-bottom:1px solid #eee;padding:10px 0;">
      <strong>${"â˜…".repeat(r.star)}</strong><br/>
      <b>${r.author}</b><br/>
      <div style="font-size:13px;">${r.text}</div>

      ${
        r.photos && r.photos.length > 0
          ? `
          <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(80px,1fr));gap:6px;margin-top:6px;">
            ${r.photos.map(url => `
              <img src="${url}" style="width:100%;height:80px;object-fit:cover;border-radius:6px;" />
            `).join("")}
          </div>
          `
          : ""
      }

      <div style="margin-top:6px;">
        <button onclick="toggleReview(${i})">
          ${r.visible ? "ë…¸ì¶œì¤‘" : "ë¹„ë…¸ì¶œ"}
        </button>
        <button onclick="deleteReview(${i})">ì‚­ì œ</button>
      </div>
    </div>
  `).join("");
}
async function toggleReview(index) {
  const review = adminReviews[index];
  if (!review) return;

  const { error } = await supabaseClient
    .from("reviews")
    .update({ visible: !review.visible })
    .eq("id", review.id);

  if (error) {
    alert("ë…¸ì¶œ ìƒíƒœ ë³€ê²½ ì‹¤íŒ¨");
    console.error(error);
    return;
  }

  loadAdminReviews();
  loadPublicReviews();
}

async function deleteReview(index) {
  const review = adminReviews[index];
  if (!review) return;

  if (!confirm("ì´ ë¦¬ë·°ë¥¼ ì‚­ì œí• ê¹Œìš”?")) return;

  const { error } = await supabaseClient
    .from("reviews")
    .delete()
    .eq("id", review.id);

  if (error) {
    alert("ë¦¬ë·° ì‚­ì œ ì‹¤íŒ¨");
    console.error(error);
    return;
  }

  loadAdminReviews();
  loadPublicReviews();
}  
    
async function uploadReviewPhotos(files) {
  const uploadedUrls = [];

  for (let i = 0; i < files.length; i++) {
    const file = files[i];

    const fileExt = file.name.split(".").pop();
    const fileName = `reviews/${crypto.randomUUID()}.${fileExt}`;

const { data, error } = await supabaseClient
  .storage
  .from("review-photos")
  .upload(fileName, file);

    if (error) {
      alert("ì‚¬ì§„ ì—…ë¡œë“œ ì‹¤íŒ¨");
      console.error(error);
      return [];
    }

const { data: publicData } = supabaseClient
  .storage
  .from("review-photos")
  .getPublicUrl(fileName);

    uploadedUrls.push(publicData.publicUrl);
  }

  return uploadedUrls;
}
async function addReview() {
  // 1) ì£¼ë¬¸ ì„ íƒ í™•ì¸
  if (!window.selectedOrderId) {
    alert("í›„ê¸°ë¥¼ ì‘ì„±í•  ì£¼ë¬¸ì„ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”.");
    return;
  }

  // 2) ë§Œì¡±ë„ ì„ íƒ í™•ì¸
  if (!adminReviewScore) {
    alert("ë§Œì¡±ë„ë¥¼ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”.");
    return;
  }

  // 3) ë™ì¼ ì£¼ë¬¸ ë¦¬ë·° ì¡´ì¬ ì—¬ë¶€ ì²´í¬ (í•µì‹¬!)
  const { data: exists, error: existsError } = await supabaseClient
    .from("reviews")
    .select("id")
    .eq("order_id", window.selectedOrderId)
    .maybeSingle();

  if (existsError) {
    console.error(existsError);
    alert("ë¦¬ë·° ì¤‘ë³µ í™•ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
    return;
  }

  if (exists) {
    alert("ì´ ì£¼ë¬¸ì—ëŠ” ì´ë¯¸ í›„ê¸°ê°€ ë“±ë¡ë˜ì–´ ìˆìŠµë‹ˆë‹¤.");
    return;
  }

  // 4) ì…ë ¥ê°’
  const author = document.getElementById("reviewAuthor").value.trim();
  const text = document.getElementById("reviewText").value.trim();
  const photoInput = document.getElementById("reviewPhotos");

  if (!author || !text) {
    alert("ì‘ì„±ìì™€ ë¦¬ë·° ë‚´ìš©ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.");
    return;
  }

  // 5) ì‚¬ì§„ ì—…ë¡œë“œ
  let photoUrls = [];
  if (photoInput && photoInput.files.length > 0) {
    if (photoInput.files.length > 10) {
      alert("ì‚¬ì§„ì€ ìµœëŒ€ 10ì¥ê¹Œì§€ë§Œ ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
      return;
    }
    photoUrls = await uploadReviewPhotos(photoInput.files);
    if (!photoUrls || photoUrls.length === 0) {
      // ì—…ë¡œë“œ ì‹¤íŒ¨í•˜ë©´ ì¤‘ë‹¨
      return;
    }
  }

  // 6) DB ì €ì¥ (order_id ë³€ìˆ˜ ì ˆëŒ€ ì‹¤ìˆ˜ ê¸ˆì§€!)
  const { error } = await supabaseClient
    .from("reviews")
.insert([{
  order_id: window.selectedOrderId,
  author,
  text,
  star: adminReviewScore,
  photos: photoUrls,
  visible: true
}]);

  if (error) {
    console.error(error);
    alert("í›„ê¸° ì €ì¥ ì‹¤íŒ¨");
    return;
  }

  // 7) ì´ˆê¸°í™”
  adminReviewScore = null;
  document.getElementById("reviewAuthor").value = "";
  document.getElementById("reviewText").value = "";
  if (photoInput) photoInput.value = "";

  alert("í›„ê¸°ê°€ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.");

  loadAdminReviews();
  loadPublicReviews();
}

/* ===============================
   ê³ ê° í™”ë©´ ë¦¬ë·° ë Œë”ë§
   =============================== */
function renderPublicReviews() {
  const box = document.getElementById("publicReviewList");
  if (!box) return;

  box.innerHTML = publicReviews.map(r => `
    <div style="background:#fff;border-radius:16px;padding:14px;box-shadow:0 6px 18px rgba(0,0,0,0.06);font-size:13px;">
      <div style="color:#f5a623;font-size:14px;margin-bottom:4px;">
        ${"â˜…".repeat(r.star)}
      </div>
     <div style="margin-bottom:6px;font-weight:600;">
  ${r.author || "ì‹¤ì œ ì´ìš© ê³ ê°"}
</div>
      <div style="color:#4b5665;">
        ${r.text}
      </div>

      ${
        r.photos && r.photos.length > 0
          ? `
          <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(90px,1fr));gap:6px;margin-top:10px;">
            ${r.photos.map(url => `
              <img src="${url}" style="width:100%;height:90px;object-fit:cover;border-radius:8px;" />
            `).join("")}
          </div>
          `
          : ""
      }

      <div style="margin-top:10px;font-size:11px;color:#8a94a6;">
        í´ë¦°ë©”ì´íŠ¸ ì‹¤ì œ ì´ìš© ê³ ê° í›„ê¸°
      </div>
    </div>
  `).join("");
}
function renderBAGallery() {
  const box = document.getElementById("baGallery");
  if (!box) return;

  box.innerHTML = publicReviews
    .filter(r => r.visible && r.photos && r.photos.length > 0)
    .flatMap(r => r.photos)
    .map(url => `
      <div class="ba-card">
        <img src="${url}" />
        <div class="ba-card-footer">
          <span>ì‹¤ì œ ê³ ê° ì‘ì—…</span>
          <span class="tag">í›„ê¸° ê¸°ë°˜</span>
        </div>
      </div>
    `)
    .join("");
}
document.addEventListener("DOMContentLoaded", () => {
  loadPublicReviews();
});

function renderCompanies() {
  const list = document.getElementById("companyList");
  if (!list) return;

  list.innerHTML = companies.map((c, i) => `
    <div style="border-bottom:1px solid #eee;padding:10px 0;">
      <b>${c.name}</b>
<span style="
  margin-left:6px;
  font-size:11px;
  padding:2px 8px;
  border-radius:999px;
  background:${c.visible ? "#e3f2fd" : "#fbe9e7"};
  color:${c.visible ? "#1565c0" : "#c62828"};
">
  ${c.visible ? "ë…¸ì¶œì¤‘" : "ë¹„ë…¸ì¶œ"}
</span><br/>
      <div style="font-size:13px;color:#555;">${c.desc}</div>

      <div style="margin-top:6px;">
        <button onclick="toggleCompany(${i})">
          ${c.visible ? "ë…¸ì¶œì¤‘" : "ë¹„ë…¸ì¶œ"}
        </button>
        <button onclick="deleteCompany(${i})">ì‚­ì œ</button>
      </div>
    </div>
  `).join("");
}

function addCompany() {
  const name = document.getElementById("companyName").value;
  const desc = document.getElementById("companyDesc").value;
  const image = document.getElementById("companyImage").value;

  if (!name || !desc) {
    alert("ì—…ì²´ëª…ê³¼ ì†Œê°œê¸€ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.");
    return;
  }

  companies.unshift({
    name,
    desc,
    rating: 5,
    visible: true,
    image
  });

  renderCompanies();
}

function toggleCompany(i) {
  companies[i].visible = !companies[i].visible;
  renderCompanies();
}
function renderCustomers() {
  const list = document.getElementById("customerList");
  if (!list) return;

  list.innerHTML = customers.map((c, i) => `
    <div style="
      background:#fff;
      border-radius:12px;
      padding:14px;
      margin-bottom:12px;
      box-shadow:0 6px 18px rgba(0,0,0,0.06);
    ">
      <div style="font-weight:700;">
        ${c.name}
        <span style="color:#666;font-size:12px;">
          (${c.phone})
        </span>
      </div>

      <div style="font-size:13px;color:#555;margin-top:4px;">
        ì£¼ì†Œ: ${c.address}<br>
        ì´ìš© íšŸìˆ˜: <b>${c.count}íšŒ</b>
      </div>

<textarea
  style="
    width:100%;
    margin-top:8px;
    border-radius:8px;
    border:1px solid #ddd;
    padding:8px;
    font-size:12px;
  "
  placeholder="ê´€ë¦¬ì ë©”ëª¨"
  onchange="customers[${i}].memo = this.value"
>${c.memo}</textarea>

<button
  style="
    margin-top:8px;
    padding:6px 10px;
    border:1px solid #ddd;
    border-radius:6px;
    background:#fff;
    cursor:pointer;
    font-size:12px;
  "
  onclick="deleteCustomer(${i})"
>
  ğŸ—‘ ê³ ê° ì‚­ì œ
</button>
    </div>
  `).join("");
}
function deleteCustomer(i) {
  if (confirm("ì´ ê³ ê° ì •ë³´ë¥¼ ì‚­ì œí• ê¹Œìš”?")) {
    customers.splice(i, 1);
    renderCustomers();
  }
}
function deleteCompany(i) {
  if (confirm("ì´ ì—…ì²´ë¥¼ ì‚­ì œí• ê¹Œìš”?")) {
    companies.splice(i, 1);
    renderCompanies();
  }
}
</script>

<!-- ë§¤ì¹­ ë¡œë”© í™”ë©´ -->
<div id="matchingLoading" style="
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.6);
  z-index:9999;
  align-items:center;
  justify-content:center;
  color:#fff;
  font-size:16px;
  text-align:center;
">
  <div style="
    background:#111;
    padding:24px 32px;
    border-radius:12px;
  ">
    ê³ ê°ë‹˜ê»˜ ë§ëŠ” ìš°ìˆ˜ì—…ì²´ë¥¼<br>
    5~10ë¶„ ì´ë‚´ì— ì„ ì • ì¤‘ì…ë‹ˆë‹¤.<br><br>
    ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.
  </div>
</div>
</body>
</html>























































